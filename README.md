# Software Testing Final Project - ZipGuard

ä¸€å€‹ç”¨æ–¼æª¢æ¸¬å’Œç”Ÿæˆ ZIP æª”æ¡ˆå¯ç–‘å…§å®¹çš„è»Ÿé«”æ¸¬è©¦å°ˆæ¡ˆã€‚è©²å·¥å…·èƒ½å¤ è­˜åˆ¥ ZIP æª”æ¡ˆä¸­çš„æ½›åœ¨å®‰å…¨å¨è„…ï¼Œä¸¦ç”Ÿæˆæ¸¬è©¦æ¡ˆä¾‹é€²è¡Œæ¨¡ç³Šæ¸¬è©¦ã€‚

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°

**ZipGuard** æ˜¯ä¸€å€‹ç¶œåˆæ€§çš„ ZIP æª”æ¡ˆå®‰å…¨åˆ†æå·¥å…·ï¼ŒåŒ…æ‹¬ï¼š
- **æª”æ¡ˆé©—è­‰ç³»çµ±**: æª¢æ¸¬ ZIP ä¸­çš„å¯ç–‘æ¨¡å¼å’Œå®‰å…¨å¨è„…
- **æ¸¬è©¦ç”¨ä¾‹ç”Ÿæˆå™¨**: è‡ªå‹•ç”Ÿæˆå„ç¨®æ ¼å¼çš„ ZIP æª”æ¡ˆé€²è¡Œæ¨¡ç³Šæ¸¬è©¦
- **è©³ç´°å ±å‘Š**: ç”Ÿæˆè©³ç´°çš„æª¢æ¸¬çµæœå ±å‘Š

## ğŸ—ï¸ å°ˆæ¡ˆçµæ§‹

```
Software-Testing-Final-Project/
â”œâ”€â”€ zipguard.py              # ä¸»é©—è­‰å·¥å…·
â”œâ”€â”€ generate.py              # æ¸¬è©¦ç”¨ä¾‹ç”Ÿæˆå™¨
â”œâ”€â”€ result.txt               # é©—è­‰çµæœè¼¸å‡º
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ rules.py             # ZIP æª”æ¡ˆè¦å‰‡æª¢æ¸¬
â”‚   â”œâ”€â”€ generator.py         # ZIP æª”æ¡ˆç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ utils.py             # å·¥å…·å‡½æ•¸
â”‚   â””â”€â”€ sample/
â”‚       â””â”€â”€ script.bat       # æ¸¬è©¦ç”¨æŒ‡ä»¤ç¢¼
â””â”€â”€ tests/
    â”œâ”€â”€ benign/              # è‰¯æ€§ ZIP æª”æ¡ˆ
    â”œâ”€â”€ suspicious/          # å¯ç–‘ ZIP æª”æ¡ˆ
    â””â”€â”€ generate/            # è‡ªå‹•ç”Ÿæˆçš„æ¸¬è©¦æª”æ¡ˆ
```

## ğŸ” ä¸»è¦åŠŸèƒ½

### 1. ZIP æª”æ¡ˆé©—è­‰ (`zipguard.py`)

æª¢æ¸¬ä»¥ä¸‹å¯ç–‘è¡Œç‚ºï¼š

- **å°¾éƒ¨ç©ºç™½æª¢æ¸¬** (`trailing_whitespace`)
  - æª¢æŸ¥æª”æ¡ˆåç¨±ä¸­çš„å°¾éƒ¨ç©ºç™½ç¬¦è™Ÿ

- **å¯åŸ·è¡Œæª”è¡çªæª¢æ¸¬** (`file_exe_collision`)
  - è­˜åˆ¥å¯åŸ·è¡Œæª”æ¡ˆèˆ‡éå¯åŸ·è¡Œæª”æ¡ˆçš„å‘½åè¡çª
  - æª¢æ¸¬ç•°å¸¸çš„å¯åŸ·è¡Œæª”æ¡ˆ (.bat, .cmd, .exe)

- **æª”æ¡ˆç›®éŒ„è¡çªæª¢æ¸¬** (`file_dir_collision`)
  - æª¢æŸ¥åŒä¸€å±¤ç´šä¸­ç›¸åŒåç¨±çš„æª”æ¡ˆå’Œç›®éŒ„

- **æ·±å±¤åµŒå¥—å¯åŸ·è¡Œæª”** (`deep_nested_executable`)
  - æª¢æ¸¬æ·±å±¤ç›®éŒ„çµæ§‹ä¸­éš±è—çš„å¯åŸ·è¡Œæª”æ¡ˆ

### 2. æ¸¬è©¦ç”¨ä¾‹ç”Ÿæˆ (`generate.py`)

è‡ªå‹•ç”Ÿæˆå„ç¨®æ ¼å¼çš„ ZIP æª”æ¡ˆç”¨æ–¼æ¸¬è©¦ï¼š

- **éš¨æ©Ÿåƒåœ¾æ•¸æ“šæ³¨å…¥**: åœ¨æª”æ¡ˆåç¨±ä¸­æ’å…¥éš¨æ©Ÿå­—ç¯€
- **æ¨¡ç³Šå‘é‡**: åŒ…å«ç‰¹æ®Šå­—ç¬¦ã€è·¯å¾‘éæ­·ã€æ ¼å¼å­—ç¬¦ä¸²ç­‰
- **ç·¨ç¢¼å•é¡Œ**: æ¸¬è©¦é ASCII å’Œ Latin-1 ç·¨ç¢¼çš„è™•ç†
- **ç·©è¡å€æº¢å‡º**: ç”Ÿæˆè¶…é•·æª”æ¡ˆåç¨±

**æ¨¡ç³Šå‘é‡åŒ…æ‹¬**ï¼š
- ç©ºç™½èˆ‡ Null å­—ç¬¦
- æ›è¡Œç¬¦ (CR, LF)
- è·¯å¾‘åˆ†éš”ç¬¦
- æª”æ¡ˆç³»çµ±ä¿ç•™å­—
- é ASCII å­—ç¬¦
- Format String
- Path Traversal

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### é©—è­‰ ZIP æª”æ¡ˆ

```bash
python zipguard.py --zip_path <path_to_zip> [--zip_file <filename>] -o <output_file>
```

**åƒæ•¸èªªæ˜**ï¼š
- `--zip_path`: ZIP æª”æ¡ˆæ‰€åœ¨çš„ç›®éŒ„
- `--zip_file`: (å¯é¸) æŒ‡å®šå–®å€‹ ZIP æª”æ¡ˆåç¨±
- `-o`: è¼¸å‡ºçµæœæª”æ¡ˆåç¨±

**ç¯„ä¾‹**ï¼š
```bash
# æª¢æ¸¬å–®å€‹æª”æ¡ˆ
python zipguard.py --zip_path ./tests/benign/ --zip_file test1.zip -o result.txt

# æª¢æ¸¬æ•´å€‹ç›®éŒ„
python zipguard.py --zip_path ./tests/suspicious/ -o result.txt
```

### ç”Ÿæˆæ¸¬è©¦ç”¨ä¾‹

```bash
python generate.py --max_depth <depth> --rules <rule_type> --tar_layer <layer> [--num_cases <count>]
```

**åƒæ•¸èªªæ˜**ï¼š
- `--max_depth`: æœ€å¤§ç›®éŒ„æ·±åº¦
- `--rules`: æ‡‰ç”¨çš„è¦å‰‡é¡å‹ (å¦‚ 'fec' - file/executable/collision)
- `--tar_layer`: ç›®æ¨™å±¤ç´š
- `--num_cases`: (å¯é¸) ç”Ÿæˆçš„æ¸¬è©¦ç”¨ä¾‹æ•¸é‡

## ğŸ“Š è¼¸å‡ºçµæœ

é©—è­‰çµæœåŒ…æ‹¬ï¼š

```
[Info] test.zip check result:
--- Trailing Whitespace    : False
--- Abnormal Executable    : False
--- File Dir Collision     : False
--- Deep Nested Executable : False
```

çµæœèªªæ˜ï¼š
- `True`: æª¢æ¸¬åˆ°å¯ç–‘è¡Œç‚º
- `False`: æœªæª¢æ¸¬åˆ°å¯ç–‘è¡Œç‚º

## ğŸ”§ ä¾è³´è¦æ±‚

- Python 3.6+
- numpy
- zipfile (å…§å»º)
- pathlib (å…§å»º)

## ğŸ“ æ ¸å¿ƒæ¨¡å¡Š

### `src/rules.py`
å®šç¾© `Zip_Rules` é¡ï¼ŒåŒ…å«æ‰€æœ‰å®‰å…¨æª¢æ¸¬è¦å‰‡

### `src/generator.py`
å®šç¾© `Zip_Generator` é¡ï¼Œè² è²¬ç”Ÿæˆå„ç¨®æ¸¬è©¦ ZIP æª”æ¡ˆ

### `src/utils.py`
æä¾›å·¥å…·å‡½æ•¸æ”¯æŒ

## ğŸ§ª æ¸¬è©¦ç›®éŒ„

- **tests/benign/**: åŒ…å«è‰¯æ€§ ZIP æª”æ¡ˆ (æ­£å¸¸çµæ§‹)
- **tests/suspicious/**: åŒ…å«å¯ç–‘ ZIP æª”æ¡ˆ (å«æœ‰å¨è„…)
- **tests/generate/**: è‡ªå‹•ç”Ÿæˆçš„æ¸¬è©¦ç”¨ä¾‹

## âš™ï¸ é…ç½®åƒæ•¸ (generate.py)

```python
OUTPUT_DIR = "fuzz_output_massive"          # è¼¸å‡ºç›®éŒ„
NUM_TEST_CASES = 100                        # ç”Ÿæˆçš„æ¸¬è©¦ç”¨ä¾‹æ•¸é‡
MAX_DEPTH = 5                               # æœ€å¤§ç›®éŒ„æ·±åº¦
BAIT_CONTENT = b"This is a harmless..."     # èª˜é¤Œå…§å®¹
SCRIPT_CONTENT = b"calc.exe"                # æ¸¬è©¦æŒ‡ä»¤ç¢¼å…§å®¹
```

## ğŸ“ License

æ­¤å°ˆæ¡ˆç‚ºè»Ÿé«”æ¸¬è©¦èª²ç¨‹çš„æœ€çµ‚å°ˆæ¡ˆã€‚

## ğŸ‘¨â€ğŸ’» é–‹ç™¼è€…

è»Ÿé«”æ¸¬è©¦èª²ç¨‹ - æœ€çµ‚å°ˆæ¡ˆ

---

**æœ€å¾Œæ›´æ–°**: 2025å¹´12æœˆ
